<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; pylim 1.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=9d552775"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="Setup" href="setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pylim
          </a>
              <div class="version">
                1.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.bacardi">bacardi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bacardi.fdw_attitude_correction"><code class="docutils literal notranslate"><span class="pre">fdw_attitude_correction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bacardi.read_bacardi_raw"><code class="docutils literal notranslate"><span class="pre">read_bacardi_raw()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.bahamas">bahamas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bahamas.calculate_distances"><code class="docutils literal notranslate"><span class="pre">calculate_distances()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bahamas.get_position"><code class="docutils literal notranslate"><span class="pre">get_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bahamas.plot_bahamas_flight_track"><code class="docutils literal notranslate"><span class="pre">plot_bahamas_flight_track()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.bahamas.preprocess_bahamas"><code class="docutils literal notranslate"><span class="pre">preprocess_bahamas()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.cirrus_hl">cirrus_hl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.ecrad">ecrad</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.apply_ice_effective_radius"><code class="docutils literal notranslate"><span class="pre">apply_ice_effective_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.apply_liquid_effective_radius"><code class="docutils literal notranslate"><span class="pre">apply_liquid_effective_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_ice_optics_baran2016"><code class="docutils literal notranslate"><span class="pre">calc_ice_optics_baran2016()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_ice_optics_baran2017"><code class="docutils literal notranslate"><span class="pre">calc_ice_optics_baran2017()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_ice_optics_fu_lw"><code class="docutils literal notranslate"><span class="pre">calc_ice_optics_fu_lw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_ice_optics_fu_sw"><code class="docutils literal notranslate"><span class="pre">calc_ice_optics_fu_sw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_ice_optics_yi"><code class="docutils literal notranslate"><span class="pre">calc_ice_optics_yi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calc_pressure"><code class="docutils literal notranslate"><span class="pre">calc_pressure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.calculate_pressure_height"><code class="docutils literal notranslate"><span class="pre">calculate_pressure_height()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.cloud_overlap_decorr_len"><code class="docutils literal notranslate"><span class="pre">cloud_overlap_decorr_len()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.get_input_version"><code class="docutils literal notranslate"><span class="pre">get_input_version()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.get_model_level_of_altitude"><code class="docutils literal notranslate"><span class="pre">get_model_level_of_altitude()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.get_version_name"><code class="docutils literal notranslate"><span class="pre">get_version_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.ice_effective_radius"><code class="docutils literal notranslate"><span class="pre">ice_effective_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.liquid_effective_radius"><code class="docutils literal notranslate"><span class="pre">liquid_effective_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.ecrad.make_ecrad_version_overview_csv"><code class="docutils literal notranslate"><span class="pre">make_ecrad_version_overview_csv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.halo_ac3">halo_ac3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.helpers">helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.cb_color_cycles"><code class="docutils literal notranslate"><span class="pre">cb_color_cycles</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.arg_nearest"><code class="docutils literal notranslate"><span class="pre">arg_nearest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.delete_folder_contents"><code class="docutils literal notranslate"><span class="pre">delete_folder_contents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.find_bases_tops"><code class="docutils literal notranslate"><span class="pre">find_bases_tops()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.generate_specific_rows"><code class="docutils literal notranslate"><span class="pre">generate_specific_rows()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.get_cb_friendly_colors"><code class="docutils literal notranslate"><span class="pre">get_cb_friendly_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.get_path"><code class="docutils literal notranslate"><span class="pre">get_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.hellinger_distance"><code class="docutils literal notranslate"><span class="pre">hellinger_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.longitude_values_for_gaussian_grid"><code class="docutils literal notranslate"><span class="pre">longitude_values_for_gaussian_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.make_dir"><code class="docutils literal notranslate"><span class="pre">make_dir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.make_flag"><code class="docutils literal notranslate"><span class="pre">make_flag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.nested_dict_pairs_iterator"><code class="docutils literal notranslate"><span class="pre">nested_dict_pairs_iterator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.nested_dict_values_iterator"><code class="docutils literal notranslate"><span class="pre">nested_dict_values_iterator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.read_command_line_args"><code class="docutils literal notranslate"><span class="pre">read_command_line_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.set_cb_friendly_colors"><code class="docutils literal notranslate"><span class="pre">set_cb_friendly_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.set_xticks_and_xlabels"><code class="docutils literal notranslate"><span class="pre">set_xticks_and_xlabels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.set_yticks_and_ylabels"><code class="docutils literal notranslate"><span class="pre">set_yticks_and_ylabels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.helpers.strtobool"><code class="docutils literal notranslate"><span class="pre">strtobool()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.libradtran">libradtran</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.libradtran.find_closest_radiosonde_station"><code class="docutils literal notranslate"><span class="pre">find_closest_radiosonde_station()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.libradtran.get_info_from_libradtran_input"><code class="docutils literal notranslate"><span class="pre">get_info_from_libradtran_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.libradtran.get_netcdf_global_attributes"><code class="docutils literal notranslate"><span class="pre">get_netcdf_global_attributes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.libradtran.get_netcdf_variable_attributes"><code class="docutils literal notranslate"><span class="pre">get_netcdf_variable_attributes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.libradtran.run_uvspec_parallel"><code class="docutils literal notranslate"><span class="pre">run_uvspec_parallel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.meteorological_formulas">meteorological_formulas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.barometric_height"><code class="docutils literal notranslate"><span class="pre">barometric_height()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.barometric_height_simple"><code class="docutils literal notranslate"><span class="pre">barometric_height_simple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.calculate_absorption_coefficient_terrestrial"><code class="docutils literal notranslate"><span class="pre">calculate_absorption_coefficient_terrestrial()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.calculate_direct_sea_ice_albedo_ebert"><code class="docutils literal notranslate"><span class="pre">calculate_direct_sea_ice_albedo_ebert()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.calculate_extinction_coefficient_solar"><code class="docutils literal notranslate"><span class="pre">calculate_extinction_coefficient_solar()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.calculate_open_ocean_albedo_taylor"><code class="docutils literal notranslate"><span class="pre">calculate_open_ocean_albedo_taylor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.meteorological_formulas.relative_humidity_water_to_relative_humidity_ice"><code class="docutils literal notranslate"><span class="pre">relative_humidity_water_to_relative_humidity_ice()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.reader">reader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_bacardi_raw"><code class="docutils literal notranslate"><span class="pre">read_bacardi_raw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_bahamas"><code class="docutils literal notranslate"><span class="pre">read_bahamas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_cams_file"><code class="docutils literal notranslate"><span class="pre">read_cams_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_ecrad_output"><code class="docutils literal notranslate"><span class="pre">read_ecrad_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_ins_gps_pos"><code class="docutils literal notranslate"><span class="pre">read_ins_gps_pos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_ins_gps_vel"><code class="docutils literal notranslate"><span class="pre">read_ins_gps_vel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_lamp_file"><code class="docutils literal notranslate"><span class="pre">read_lamp_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_libradtran"><code class="docutils literal notranslate"><span class="pre">read_libradtran()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_nav_data"><code class="docutils literal notranslate"><span class="pre">read_nav_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_ozone_sonde"><code class="docutils literal notranslate"><span class="pre">read_ozone_sonde()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_pixel_to_wavelength"><code class="docutils literal notranslate"><span class="pre">read_pixel_to_wavelength()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_smart_cor"><code class="docutils literal notranslate"><span class="pre">read_smart_cor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_smart_raw"><code class="docutils literal notranslate"><span class="pre">read_smart_raw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.reader.read_stabbi_data"><code class="docutils literal notranslate"><span class="pre">read_stabbi_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.smart">smart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.correct_smart_dark_current"><code class="docutils literal notranslate"><span class="pre">correct_smart_dark_current()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.find_pixel"><code class="docutils literal notranslate"><span class="pre">find_pixel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.get_dark_current"><code class="docutils literal notranslate"><span class="pre">get_dark_current()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.get_info_from_filename"><code class="docutils literal notranslate"><span class="pre">get_info_from_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.merge_vnir_swir_nc"><code class="docutils literal notranslate"><span class="pre">merge_vnir_swir_nc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_calibrated_irradiance_flux"><code class="docutils literal notranslate"><span class="pre">plot_calibrated_irradiance_flux()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_complete_smart_spectra"><code class="docutils literal notranslate"><span class="pre">plot_complete_smart_spectra()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_complete_smart_spectra_interactive"><code class="docutils literal notranslate"><span class="pre">plot_complete_smart_spectra_interactive()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_mean_corrected_measurement"><code class="docutils literal notranslate"><span class="pre">plot_mean_corrected_measurement()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_smart_data"><code class="docutils literal notranslate"><span class="pre">plot_smart_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_smart_data_interactive"><code class="docutils literal notranslate"><span class="pre">plot_smart_data_interactive()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_smart_ecrad_bands"><code class="docutils literal notranslate"><span class="pre">plot_smart_ecrad_bands()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.smart.plot_smart_spectra"><code class="docutils literal notranslate"><span class="pre">plot_smart_spectra()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pylim.solar_position">solar_position</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.dec"><code class="docutils literal notranslate"><span class="pre">dec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.get_saa"><code class="docutils literal notranslate"><span class="pre">get_saa()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.get_sza"><code class="docutils literal notranslate"><span class="pre">get_sza()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.julian_day"><code class="docutils literal notranslate"><span class="pre">julian_day()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.local_time"><code class="docutils literal notranslate"><span class="pre">local_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylim.solar_position.refract"><code class="docutils literal notranslate"><span class="pre">refract()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pylim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api_documentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pylim">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-pylim" title="Link to this heading"></a></h1>
<p>Init file for pylim a package designed to work with measurement data for the radiation group at LIM
author: Johannes Röttenbacher</p>
<section id="module-pylim.bacardi">
<span id="bacardi"></span><h2>bacardi<a class="headerlink" href="#module-pylim.bacardi" title="Link to this heading"></a></h2>
<p>Functions to read in quicklook files and attitude correction</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.bacardi.fdw_attitude_correction">
<span class="sig-prename descclassname"><span class="pre">pylim.bacardi.</span></span><span class="sig-name descname"><span class="pre">fdw_attitude_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fdw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pitch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sza</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/bacardi.html#fdw_attitude_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bacardi.fdw_attitude_correction" title="Link to this definition"></a></dt>
<dd><p>Attitude Correction for downward irradiance.
Corrects downward irradiance for misalignment of the sensor (deviation from horizontal alignment).</p>
<ul class="simple">
<li><p>only direct fraction of irradiance can be corrected by the equation, therefore a direct fraction (fdir) has to be provided</p></li>
<li><p>please check correct definition of the attitude angle</p></li>
<li><p>for differences between the sensor attitude and the attitude given by an INS the offset angles (p_off and r_off) can be defined.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fdw</strong> – downward irradiance [W m-2] or [W m-2 nm-1]</p></li>
<li><p><strong>roll</strong> – roll angle [deg] - defined positive for left wing up</p></li>
<li><p><strong>pitch</strong> – pitch angle [deg] - defined positive for nose down</p></li>
<li><p><strong>yaw</strong> – yaw angle [deg] - defined clockwise with North=0°</p></li>
<li><p><strong>sza</strong> – solar zenith angle [deg]</p></li>
<li><p><strong>saa</strong> – solar azimuth angle [deg] - defined clockwise with North=0°</p></li>
<li><p><strong>r_off</strong> – roll offset angle between INS and sensor [deg] - defined positive for left wing up</p></li>
<li><p><strong>p_off</strong> – pitch offset angle between INS and sensor [deg] - defined positive for nose down</p></li>
<li><p><strong>fdir</strong> – fraction of direct radiation [0..1] (0=pure diffuse, 1=pure direct)</p></li>
</ul>
</dd>
</dl>
<p>Returns: corrected downward irradiance [W m-2] or [W m-2 nm-1] and correction factor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.bacardi.read_bacardi_raw">
<span class="sig-prename descclassname"><span class="pre">pylim.bacardi.</span></span><span class="sig-name descname"><span class="pre">read_bacardi_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/bacardi.html#read_bacardi_raw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bacardi.read_bacardi_raw" title="Link to this definition"></a></dt>
<dd><p>Read raw BACARDI data as provided by DLR</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of file</p></li>
<li><p><strong>path</strong> – path to file</p></li>
</ul>
</dd>
</dl>
<p>Returns: Dataset with BACARDI data and time as dimension</p>
</dd></dl>

</section>
<section id="module-pylim.bahamas">
<span id="bahamas"></span><h2>bahamas<a class="headerlink" href="#module-pylim.bahamas" title="Link to this heading"></a></h2>
<p>Functions to work with BAHAMAS data</p>
<ul class="simple">
<li><p>dictionary with plot properties for quicklook maps</p></li>
<li><p>function to plot BAHAMAS map</p></li>
<li><p>get position</p></li>
<li><p>preprocess function for multiple file read in</p></li>
<li><p>function to calculate distance between two bahamas samples</p></li>
</ul>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.bahamas.calculate_distances">
<span class="sig-prename descclassname"><span class="pre">pylim.bahamas.</span></span><span class="sig-name descname"><span class="pre">calculate_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/bahamas.html#calculate_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bahamas.calculate_distances" title="Link to this definition"></a></dt>
<dd><p>Calculate geodesic distance between each aircraft time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> – BAHAMAS dataset</p>
</dd>
</dl>
<p>Returns: New dataset with geodesic distances</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.bahamas.get_position">
<span class="sig-prename descclassname"><span class="pre">pylim.bahamas.</span></span><span class="sig-name descname"><span class="pre">get_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Timestamp</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pylim/bahamas.html#get_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bahamas.get_position" title="Link to this definition"></a></dt>
<dd><p>Given the flight and the exact time, get HALOs position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight</strong> – Which flight to read in</p></li>
<li><p><strong>timestamp</strong> – exact time</p></li>
</ul>
</dd>
</dl>
<p>Returns: latitude (deg), longitude (deg), altitude (m)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.bahamas.plot_bahamas_flight_track">
<span class="sig-prename descclassname"><span class="pre">pylim.bahamas.</span></span><span class="sig-name descname"><span class="pre">plot_bahamas_flight_track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/bahamas.html#plot_bahamas_flight_track"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bahamas.plot_bahamas_flight_track" title="Link to this definition"></a></dt>
<dd><p>Plot a map of the flight track from BAHAMAS data with the location of HALO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight</strong> – Flight name (eg. Flight_20210707a)</p></li>
<li><p><strong>**kwargs</strong> – outpath (str): where to save plot (default: bahamas_dir/plots)</p></li>
</ul>
</dd>
</dl>
<p>Returns: Saves a png file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.bahamas.preprocess_bahamas">
<span class="sig-prename descclassname"><span class="pre">pylim.bahamas.</span></span><span class="sig-name descname"><span class="pre">preprocess_bahamas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/bahamas.html#preprocess_bahamas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.bahamas.preprocess_bahamas" title="Link to this definition"></a></dt>
<dd><p>Preprocessing function for xarray.read_mfdataset()</p>
<p>Returns: Dataset with dimension time</p>
</dd></dl>

</section>
<section id="module-pylim.cirrus_hl">
<span id="cirrus-hl"></span><h2>cirrus_hl<a class="headerlink" href="#module-pylim.cirrus_hl" title="Link to this heading"></a></h2>
<p>General information about the CIRRUS-HL campaign</p>
<ul class="simple">
<li><p>lookup dictionary to look up which spectrometer belongs to which inlet, which inlet is measuring up or downward irradiance and which filename part belongs to which channel</p></li>
<li><p>dictionary relating flight with flight number</p></li>
<li><p>BACARDI offsets</p></li>
<li><p>dictionary which relates each measurement with the date of the transfer calibration for that measurement.</p></li>
<li><p>take off and landing times according to BAHAMAS</p></li>
<li><p>gopro local time and BAHAMAS time offset</p></li>
<li><p>stop over locations for each double flight</p></li>
<li><p>coordinates of airports</p></li>
<li><p>radiosonde stations</p></li>
<li><p>specific flight sections</p></li>
<li><p>flight hours</p></li>
<li><p>ozone files</p></li>
</ul>
<p><em>author</em>: Johannes Röttenbacher</p>
</section>
<section id="module-pylim.ecrad">
<span id="ecrad"></span><h2>ecrad<a class="headerlink" href="#module-pylim.ecrad" title="Link to this heading"></a></h2>
<p>Functions translated from FORTRAN code in ecRad</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.apply_ice_effective_radius">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">apply_ice_effective_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#apply_ice_effective_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.apply_ice_effective_radius" title="Link to this definition"></a></dt>
<dd><p>Apply ice effective radius function over a whole dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> – IFS DataSet</p>
</dd>
</dl>
<p>Returns: DataSet with new variable re_ice containing the ice effective radius for each point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.apply_liquid_effective_radius">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">apply_liquid_effective_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#apply_liquid_effective_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.apply_liquid_effective_radius" title="Link to this definition"></a></dt>
<dd><p>Apply liquid effective radius function over a whole dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> – IFS DataSet</p>
</dd>
</dl>
<p>Returns: DataSet with new variable re_ice containing the ice effective radius for each point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_ice_optics_baran2016">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_ice_optics_baran2016</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_ice_optics_baran2016"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_ice_optics_baran2016" title="Link to this definition"></a></dt>
<dd><p>Compute ice-particle scattering properties using a parameterization as a function of ice water mixing ratio
and temperature.</p>
<p>From radiation_ice_optics_baran2016.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2016- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Author:  Robin Hogan</div>
<div class="line">Email:   <a class="reference external" href="mailto:r&#46;j&#46;hogan&#37;&#52;&#48;ecmwf&#46;int">r<span>&#46;</span>j<span>&#46;</span>hogan<span>&#64;</span>ecmwf<span>&#46;</span>int</a></div>
</div>
<div class="line-block">
<div class="line">Modifications</div>
<div class="line-block">
<div class="line">2023-03-09  J. Röttenbacher  Translated to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> – ‘sw’ or ‘lw’, shortwave or longwave bands</p></li>
<li><p><strong>ice_wp</strong> – Ice water path (kg m-2)</p></li>
<li><p><strong>qi</strong> – Mixing ratio (kg kg-1)</p></li>
<li><p><strong>temperature</strong> – Temperature (K)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total optical depth
scat_od: Scattering optical depth
g: Asymmetry factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>od</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_ice_optics_baran2017">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_ice_optics_baran2017</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_ice_optics_baran2017"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_ice_optics_baran2017" title="Link to this definition"></a></dt>
<dd><p>Compute ice-particle scattering properties using a parameterization as a function of ice water mixing ratio
and temperature.</p>
<p>From radiation_ice_optics_baran2017.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2017- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Author:  Robin Hogan</div>
<div class="line">Email:   <a class="reference external" href="mailto:r&#46;j&#46;hogan&#37;&#52;&#48;ecmwf&#46;int">r<span>&#46;</span>j<span>&#46;</span>hogan<span>&#64;</span>ecmwf<span>&#46;</span>int</a></div>
</div>
<div class="line-block">
<div class="line">Modifications</div>
<div class="line-block">
<div class="line">2023-03-06  J. Röttenbacher  Translated to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> – ‘sw’ or ‘lw’, shortwave or longwave bands</p></li>
<li><p><strong>ice_wp</strong> – Ice water path (kg m-2)</p></li>
<li><p><strong>qi</strong> – Mixing ratio (kg kg-1)</p></li>
<li><p><strong>temperature</strong> – Temperature (K)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total optical depth
scat_od: Scattering optical depth
g: Asymmetry factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>od</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_ice_optics_fu_lw">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_ice_optics_fu_lw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_eff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_ice_optics_fu_lw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_ice_optics_fu_lw" title="Link to this definition"></a></dt>
<dd><p>Compute longwave ice-particle scattering properties using Fu et al. (1998) parameterization.</p>
<p>From radiation_ice_optics_fu.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2014- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Author:  Robin Hogan</div>
<div class="line">Email:   <a class="reference external" href="mailto:r&#46;j&#46;hogan&#37;&#52;&#48;ecmwf&#46;int">r<span>&#46;</span>j<span>&#46;</span>hogan<span>&#64;</span>ecmwf<span>&#46;</span>int</a></div>
</div>
<div class="line-block">
<div class="line">Modifications</div>
<div class="line-block">
<div class="line">2020-08-10  R. Hogan  Bounded r_eff to be &lt;= 100um and g to be &lt; 1.0</div>
<div class="line">2023-03-06  J. Röttenbacher  Translated to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice_wp</strong> – Ice water path (kg m-2)</p></li>
<li><p><strong>r_eff</strong> – Effective radius (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total optical depth
scat_od: Scattering optical depth
g: Asymmetry factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>od</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_ice_optics_fu_sw">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_ice_optics_fu_sw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_eff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_ice_optics_fu_sw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_ice_optics_fu_sw" title="Link to this definition"></a></dt>
<dd><p>Compute shortwave ice-particle scattering properties using Fu (1996) parameterization.
The asymmetry factor in band 14 goes larger than one for r_eff &gt; 100.8 um, so we cap r_eff at 100 um.
Asymmetry factor is capped at just less than 1 because if it is exactly 1 then delta-Eddington scaling leads to a
zero scattering optical depth and then division by zero.</p>
<p>From radiation_ice_optics_fu.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2014- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Author:  Robin Hogan</div>
<div class="line">Email:   <a class="reference external" href="mailto:r&#46;j&#46;hogan&#37;&#52;&#48;ecmwf&#46;int">r<span>&#46;</span>j<span>&#46;</span>hogan<span>&#64;</span>ecmwf<span>&#46;</span>int</a></div>
</div>
<div class="line-block">
<div class="line">Modifications</div>
<div class="line-block">
<div class="line">2020-08-10  R. Hogan  Bounded r_eff to be &lt;= 100um and g to be &lt; 1.0</div>
<div class="line">2023-03-06  J. Röttenbacher  Translated to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice_wp</strong> – Ice water path (kg m-2)</p></li>
<li><p><strong>r_eff</strong> – Effective radius (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total optical depth
scat_od: Scattering optical depth
g: Asymmetry factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>od</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_ice_optics_yi">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_ice_optics_yi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice_wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_eff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_ice_optics_yi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_ice_optics_yi" title="Link to this definition"></a></dt>
<dd><p>Compute shortwave ice-particle scattering properties using Yi et al. (2013) parameterization.</p>
<p>From radiation_ice_optics_yi.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2017- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Authors:  Mark Fielding and Robin Hogan</div>
<div class="line">Email:   <a class="reference external" href="mailto:r&#46;j&#46;hogan&#37;&#52;&#48;ecmwf&#46;int">r<span>&#46;</span>j<span>&#46;</span>hogan<span>&#64;</span>ecmwf<span>&#46;</span>int</a></div>
</div>
<p>The reference for this ice optics parameterization is:
Yi, B., P. Yang, B.A. Baum, T. L’Ecuyer, L. Oreopoulos, E.J. Mlawer, A.J. Heymsfield, and K. Liou, 2013:
Influence of Ice Particle Surface Roughening on the Global Cloud Radiative Effect. J. Atmos. Sci., 70, 2794–2807,
<a class="reference external" href="https://doi.org/10.1175/JAS-D-13-020.1">https://doi.org/10.1175/JAS-D-13-020.1</a></p>
<div class="line-block">
<div class="line">Modifications:</div>
<div class="line-block">
<div class="line">2023-03-06  J. Röttenbacher  Translated to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> – ‘sw’ or ‘lw’, shortwave or longwave bands</p></li>
<li><p><strong>ice_wp</strong> – Ice water path (kg m-2)</p></li>
<li><p><strong>r_eff</strong> – effective radius (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total optical depth
scat_od: Scattering optical depth
g: Asymmetry factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>od</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calc_pressure">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calc_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#calc_pressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calc_pressure" title="Link to this definition"></a></dt>
<dd><p>Calculate the pressure at half and full hybrid model level.
See <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+compute+pressure+and+geopotential+on+model+levels%2C+geopotential+height+and+geometric+height">https://confluence.ecmwf.int/display/CKB/ERA5%3A+compute+pressure+and+geopotential+on+model+levels%2C+geopotential+height+and+geometric+height</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> – DataSet as provided from the IFS output</p>
</dd>
</dl>
<p>Returns: DataSet with pressure at half and full model level</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.calculate_pressure_height">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">calculate_pressure_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#calculate_pressure_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.calculate_pressure_height" title="Link to this definition"></a></dt>
<dd><p>Calculate the pressure height for the half and full model levels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> – Dataset with temperature and pressure on model half and full levels (<code class="docutils literal notranslate"><span class="pre">pressure_hl</span></code>, <code class="docutils literal notranslate"><span class="pre">temperature_hl</span></code>,
<code class="docutils literal notranslate"><span class="pre">pressure_full</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>)</p>
</dd>
</dl>
<p>Returns: Dataset with two new variables <code class="docutils literal notranslate"><span class="pre">press_height_hl</span></code> and <code class="docutils literal notranslate"><span class="pre">press_height_full</span></code> in meters</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.cloud_overlap_decorr_len">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">cloud_overlap_decorr_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#cloud_overlap_decorr_len"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.cloud_overlap_decorr_len" title="Link to this definition"></a></dt>
<dd><p>Implementation of the overlap decorrelation length parameter according to Shonk et al. 2010 (<a class="reference external" href="https://doi.org/10.1002/qj.647">https://doi.org/10.1002/qj.647</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> – Latitude of IFS grid cell</p></li>
<li><p><strong>scheme</strong> – Which scheme to apply?</p></li>
</ul>
</dd>
</dl>
<p>Returns: decorr_len_edges_km, decorr_len_water_km, decorr_len_ratio</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.get_input_version">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">get_input_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#get_input_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.get_input_version" title="Link to this definition"></a></dt>
<dd><p>Return input version to given version string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> – version string (e.g. v15.1)</p>
</dd>
</dl>
<p>Returns: Name of version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.get_model_level_of_altitude">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">get_model_level_of_altitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">altitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#get_model_level_of_altitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.get_model_level_of_altitude" title="Link to this definition"></a></dt>
<dd><p>Retrieve the model levels corresponding to a time series of altitude values such as given by a flight path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>altitude</strong> – time series of altitude values in m, has to have the dimension time</p></li>
<li><p><strong>model_ds</strong> – model data set with index time, level and/or half_level and variables press_height_hl and/or press_height_full</p></li>
<li><p><strong>coord</strong> – which vertical coordinate to use for selection, either “half_level” or “level”</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.get_version_name">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">get_version_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#get_version_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.get_version_name" title="Link to this definition"></a></dt>
<dd><p>Return version name to given version string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> – Three character version string (e.g. v15)</p>
</dd>
</dl>
<p>Returns: Name of version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.ice_effective_radius">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">ice_effective_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PPRESSURE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PTEMPERATURE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PCLOUD_FRAC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PQ_ICE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PQ_SNOW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PLAT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#ice_effective_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.ice_effective_radius" title="Link to this definition"></a></dt>
<dd><p>From ice_effective_radius.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2016- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Purpose:</div>
<div class="line-block">
<div class="line">Calculate effective radius of ice clouds</div>
</div>
</div>
<div class="line-block">
<div class="line">Author:</div>
<div class="line-block">
<div class="line">Robin Hogan, ECMWF (using code extracted from radlswr.F90)</div>
<div class="line">Original: 2016-02-24</div>
</div>
</div>
<div class="line-block">
<div class="line">Modifications:</div>
<div class="line-block">
<div class="line">2022-09-22  J. Röttenbacher translated Sun and Rikus part to python3</div>
</div>
</div>
<p>Ice effective radius = f(T,IWC) from Sun and Rikus (1999), revised by Sun (2001)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PPRESSURE</strong> – (Pa)</p></li>
<li><p><strong>PTEMPERATURE</strong> – <ol class="upperalpha simple" start="11">
<li></li>
</ol>
</p></li>
<li><p><strong>PCLOUD_FRAC</strong> – (kg/kg)</p></li>
<li><p><strong>PQ_ICE</strong> – (kg/kg)</p></li>
<li><p><strong>PQ_SNOW</strong> – (kg/kg)</p></li>
<li><p><strong>PLAT</strong> – (degrees)</p></li>
</ul>
</dd>
</dl>
<p>Returns: ice effective radius in meter</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.liquid_effective_radius">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">liquid_effective_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PPRESSURE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PTEMPERATURE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PCLOUD_FRAC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PQ_LIQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PQ_RAIN</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/ecrad.html#liquid_effective_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.liquid_effective_radius" title="Link to this definition"></a></dt>
<dd><p>From liquid_effective_radius.F90 from the ecRad source code (<a class="reference external" href="https://github.com/ecmwf-ifs/ecrad">https://github.com/ecmwf-ifs/ecrad</a>).</p>
<ol class="upperalpha simple" start="3">
<li><p>Copyright 2015- ECMWF.</p></li>
</ol>
<p>This software is licensed under the terms of the Apache Licence Version 2.0
which can be obtained at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>In applying this licence, ECMWF does not waive the privileges and immunities
granted to it by virtue of its status as an intergovernmental organisation
nor does it submit to any jurisdiction.</p>
<div class="line-block">
<div class="line">Purpose:</div>
<div class="line-block">
<div class="line">Calculate effective radius of liquid clouds</div>
</div>
</div>
<div class="line-block">
<div class="line">Author:</div>
<div class="line-block">
<div class="line">Robin Hogan, ECMWF (using code extracted from radlswr.F90)</div>
<div class="line">Original: 2015-09-24</div>
</div>
</div>
<div class="line-block">
<div class="line">Modifications:</div>
<div class="line-block">
<div class="line">2022-09-22 J. Röttenbacher translated Martin et al. (JAS 1994) part to python3</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PPRESSURE</strong> – (Pa)</p></li>
<li><p><strong>PTEMPERATURE</strong> – <ol class="upperalpha simple" start="11">
<li></li>
</ol>
</p></li>
<li><p><strong>PCLOUD_FRAC</strong> – (kg/kg)</p></li>
<li><p><strong>PQ_LIQ</strong> – (kg/kg)</p></li>
<li><p><strong>PQ_RAIN</strong> – (kg/kg)</p></li>
</ul>
</dd>
</dl>
<p>Returns: liquid effective radius in meter after Martin et al. (JAS 1994)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.ecrad.make_ecrad_version_overview_csv">
<span class="sig-prename descclassname"><span class="pre">pylim.ecrad.</span></span><span class="sig-name descname"><span class="pre">make_ecrad_version_overview_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./docs/files'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pylim/ecrad.html#make_ecrad_version_overview_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.ecrad.make_ecrad_version_overview_csv" title="Link to this definition"></a></dt>
<dd><p>Create a csv file with information on each version of the ecRad simulations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>version_list</strong> – list of versions of ecRad simulations e.g. [1, 3, 4, 5.2]</p></li>
<li><p><strong>outpath</strong> – path where csv file should be saved to</p></li>
</ul>
</dd>
</dl>
<p>Returns: a csv file</p>
</dd></dl>

</section>
<section id="module-pylim.halo_ac3">
<span id="halo-ac3"></span><h2>halo_ac3<a class="headerlink" href="#module-pylim.halo_ac3" title="Link to this heading"></a></h2>
<p>Background information and lookup dictionaries for the HALO-AC3 campaign</p>
<ul class="simple">
<li><p>dictionary to look up which spectrometer belongs to which inlet, which inlet is measuring up or downward irradiance and which filename part belongs to which channel.</p></li>
<li><p>coordinates of airports and specific locations</p></li>
<li><p>radiosonde stations</p></li>
<li><p>flight names dictionary relates flight key to complete flight name</p></li>
<li><p>dictionary which relates each measurement with the date of the transfer calibration for that measurement.</p></li>
<li><p>take off and landing times</p></li>
<li><p>gopro offsets from BAHAMAS time</p></li>
<li><p>information on stabilization performance</p></li>
<li><p>radiation square times</p></li>
</ul>
<p><em>author</em>: Johannes Röttenbacher</p>
</section>
<section id="module-pylim.helpers">
<span id="helpers"></span><h2>helpers<a class="headerlink" href="#module-pylim.helpers" title="Link to this heading"></a></h2>
<p>General helper functions and general information</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py data">
<dt class="sig sig-object py" id="pylim.helpers.cb_color_cycles">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">cb_color_cycles</span></span><a class="headerlink" href="#pylim.helpers.cb_color_cycles" title="Link to this definition"></a></dt>
<dd><img alt="Image of the colors" src="_images/cb_color_cycles.png" />
<p>Colorblind friendly color cycles from the <a class="reference external" href="https://github.com/Nowosad/rcartocolor">rcartocolor</a> package,
the Okabe-Ito palette <span id="id1">[<a class="reference internal" href="references.html#id756" title="Color Universal Design (CUD) / Colorblind Barrier Free. https://jfly.uni-koeln.de/color/."><em>Color Universal Design (CUD) / Colorblind Barrier Free</em>, n.d.</a>]</span> and the survey from <span id="id2">Petroff [<a class="reference internal" href="references.html#id757" title="Matthew A. Petroff. Accessible Color Sequences for Data Visualization. December 2021. arXiv:2107.02270, doi:10.48550/arXiv.2107.02270.">2021</a>]</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.arg_nearest">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">arg_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#arg_nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.arg_nearest" title="Link to this definition"></a></dt>
<dd><p>Find the index of the nearest value in an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Input has to be convertible to an ndarray</p></li>
<li><p><strong>value</strong> – Value to search for</p></li>
</ul>
</dd>
</dl>
<p>Returns: index of closest value</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.delete_folder_contents">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">delete_folder_contents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#delete_folder_contents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.delete_folder_contents" title="Link to this definition"></a></dt>
<dd><p>Deletes all files and subfolders in a folder.
From: <a class="reference external" href="https://stackoverflow.com/questions/185936/how-to-delete-the-contents-of-a-folder">https://stackoverflow.com/questions/185936/how-to-delete-the-contents-of-a-folder</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder</strong> – folder name or full path</p>
</dd>
</dl>
<p>Returns: nothing, but deletes all files in a folder</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.find_bases_tops">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">find_bases_tops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#find_bases_tops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.find_bases_tops" title="Link to this definition"></a></dt>
<dd><p>This function finds cloud bases and tops for a provided binary cloud mask.
:param mask: bool array containing False = signal, True=no-signal
:type mask: np.array, dtype=bool
:param rg_list: array of range values
:type rg_list: np.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list containing a dict for every time step consisting of cloud bases/top indices, range and width
cloud_mask (np.array) : integer array, containing +1 for cloud tops, -1 for cloud bases and 0 for fill_value</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>cloud_prop (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.generate_specific_rows">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">generate_specific_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">userows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#generate_specific_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.generate_specific_rows" title="Link to this definition"></a></dt>
<dd><p>Function for trajectory plotting</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.get_cb_friendly_colors">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">get_cb_friendly_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cartocolor'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#get_cb_friendly_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.get_cb_friendly_colors" title="Link to this definition"></a></dt>
<dd><p>Get colorblind friendly color cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – Name of color cycle</p>
</dd>
</dl>
<p>Returns: List with colorblind friendly colors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.get_path">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cirrus-hl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#get_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.get_path" title="Link to this definition"></a></dt>
<dd><p>Read paths from the toml file according to the current working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – which path to return, see config.toml for possible values</p></li>
<li><p><strong>flight</strong> – for which flight should the path be provided (e.g. Flight_20210625a for CIRRUS-HL or HALO-AC3_20220311_HALO_RF01 for HALO-AC3)</p></li>
<li><p><strong>campaign</strong> – campaign for which the paths should be generated</p></li>
<li><p><strong>instrument</strong> – if key=all which instrument to generate the path to? (e.g. BAHAMAS)</p></li>
</ul>
</dd>
</dl>
<p>Returns: Path to specified data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.hellinger_distance">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">hellinger_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#hellinger_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.hellinger_distance" title="Link to this definition"></a></dt>
<dd><p>Compute the Hellinger distance between two probability distributions.</p>
<p>Parameters:
p (numpy array): Probability distribution 1 (e.g., histogram).
q (numpy array): Probability distribution 2 (e.g., histogram).</p>
<p>Returns:
float: Hellinger distance between the two distributions.</p>
<p>Reference:
- <a class="reference external" href="https://en.wikipedia.org/wiki/Hellinger_distance">https://en.wikipedia.org/wiki/Hellinger_distance</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.longitude_values_for_gaussian_grid">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">longitude_values_for_gaussian_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitudes:</span> <span class="pre">~numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points:</span> <span class="pre">~numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_boundaries:</span> <span class="pre">~numpy.array</span> <span class="pre">=</span> <span class="pre">None)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;built-in</span> <span class="pre">function</span> <span class="pre">array&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;built-in</span> <span class="pre">function</span> <span class="pre">array&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#longitude_values_for_gaussian_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.longitude_values_for_gaussian_grid" title="Link to this definition"></a></dt>
<dd><p>Calculate the longitude values for each latitude circle on a reduced Gaussian grid.
If the longitude boundaries are given only the longitude values within these boundaries are returned.</p>
<p>The ECMWF uses regular/reduced Gaussian grids to represent their model data.
These have a fixed number of latitudes between the equator and each pole with either a regular amount of longitude
points on each latitude ring or in case of a reduced Gaussian grid with a decreasing number of points towards the
poles on each latitude ring.
For more information on Gaussian grids as used by the ECMWF see: <a class="reference external" href="https://confluence.ecmwf.int/display/FCST/Gaussian+grids">https://confluence.ecmwf.int/display/FCST/Gaussian+grids</a></p>
<p>When retrieving data on a reduced Gaussian grid the exact longitude values are not included in the data set and have
to be calculated according to the definition of the grid.
For this the latitude rings (latitudes) and the amount of longitude points on each latitude ring is needed (n_points).
As one rarely retrieves the whole domain of the model the longitude boundaries are also needed to return the correct
longitude values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitudes</strong> – The latitude values of the Gaussian grid starting in the North</p></li>
<li><p><strong>n_points</strong> – The number of longitude points on each latitude circle (needs to be of same length as latitudes)</p></li>
<li><p><strong>longitude_boundaries</strong> – The longitude boundaries (E, W). E =-90, W =90, N=0, S=-180/180</p></li>
</ul>
</dd>
</dl>
<p>Returns: Two arrays with repeating latitude values and the corresponding longitude values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.make_dir">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">make_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#make_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.make_dir" title="Link to this definition"></a></dt>
<dd><p>Creates folder if it doesn’t exist already.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder</strong> – folder name or full path</p>
</dd>
</dl>
<p>Returns: nothing, but creates a new folder if possible</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.make_flag">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">make_flag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boolean_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#make_flag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.make_flag" title="Link to this definition"></a></dt>
<dd><p>Make a list of flag values for plotting using a boolean array as input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boolean_array</strong> – array like input with True and False</p></li>
<li><p><strong>name</strong> – replace True with this string</p></li>
</ul>
</dd>
</dl>
<p>Returns: list with as many strings as there are True values in the input array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.nested_dict_pairs_iterator">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">nested_dict_pairs_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#nested_dict_pairs_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.nested_dict_pairs_iterator" title="Link to this definition"></a></dt>
<dd><p>Loop over all values in a nested dictionary and return the key, value pair
See: <a class="reference external" href="https://thispointer.com/python-how-to-iterate-over-nested-dictionary-dict-of-dicts/">https://thispointer.com/python-how-to-iterate-over-nested-dictionary-dict-of-dicts/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dict_obj</strong> – nested dictionary</p>
</dd>
</dl>
<p>Returns: Each value in a nested dictionary with its key</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.nested_dict_values_iterator">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">nested_dict_values_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#nested_dict_values_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.nested_dict_values_iterator" title="Link to this definition"></a></dt>
<dd><p>Loop over all values in a nested dictionary
See: <a class="reference external" href="https://thispointer.com/python-iterate-loop-over-all-nested-dictionary-values/">https://thispointer.com/python-iterate-loop-over-all-nested-dictionary-values/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dict_obj</strong> – nested dictionary</p>
</dd>
</dl>
<p>Returns: Each value in a nested dictionary</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.read_command_line_args">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">read_command_line_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#read_command_line_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.read_command_line_args" title="Link to this definition"></a></dt>
<dd><p>Read out command line arguments and save them to a dictionary. Expects arguments in the form key=value.</p>
<p>Returns: dictionary with command line arguments as dict[key] = value</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.set_cb_friendly_colors">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">set_cb_friendly_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cartocolor'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#set_cb_friendly_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.set_cb_friendly_colors" title="Link to this definition"></a></dt>
<dd><p>Set new colorblind friendly color cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – Name of color cycle</p>
</dd>
</dl>
<p>Returns: Modifies the standard pyplot color cycle</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.set_xticks_and_xlabels">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">set_xticks_and_xlabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_extend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">axis</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#set_xticks_and_xlabels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.set_xticks_and_xlabels" title="Link to this definition"></a></dt>
<dd><p>This function sets the ticks and labels of the x-axis (only when the x-axis is time in UTC).</p>
<dl class="simple">
<dt>Options:</dt><dd><ul class="simple">
<li><p>time_extend &gt; 7 days:               major ticks every 2 day,  minor ticks every 12 hours</p></li>
<li><p>7 days &gt; time_extend &gt; 2 days:      major ticks every day, minor ticks every  6 hours</p></li>
<li><p>2 days &gt; time_extend &gt; 1 days:      major ticks every 12 hours, minor ticks every  3 hours</p></li>
<li><p>1 days &gt; time_extend &gt; 12 hours:    major ticks every 2 hours, minor ticks every  30 minutes</p></li>
<li><p>12hours &gt; time_extend &gt; 6 hours:    major ticks every 1 hours, minor ticks every  30 minutes</p></li>
<li><p>6 hours &gt; time_extend &gt; 2 hour:     major ticks every hour, minor ticks every  15 minutes</p></li>
<li><p>2 hours &gt; time_extend &gt; 30 min:     major ticks every 15 minutes, minor ticks every 5 minutes</p></li>
<li><p>30 min &gt; time_extend &gt; 5 min:       major ticks every 5 minutes, minor ticks every 1 minute</p></li>
<li><p>else:                               major ticks every minute, minor ticks every 10 seconds</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – axis in which the x-ticks and labels have to be set</p></li>
<li><p><strong>time_extend</strong> – time difference of t_end - t_start (format datetime.timedelta)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ax - axis with new ticks and labels</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.set_yticks_and_ylabels">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">set_yticks_and_ylabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_extend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">axis</span></span></span><a class="reference internal" href="_modules/pylim/helpers.html#set_yticks_and_ylabels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.set_yticks_and_ylabels" title="Link to this definition"></a></dt>
<dd><p>This function sets the ticks and labels of the y-axis (only when the y-axis is time in UTC).</p>
<dl class="simple">
<dt>Options:</dt><dd><ul class="simple">
<li><p>time_extend &gt; 7 days:               major ticks every 2 day,  minor ticks every 12 hours</p></li>
<li><p>7 days &gt; time_extend &gt; 2 days:      major ticks every day, minor ticks every  6 hours</p></li>
<li><p>2 days &gt; time_extend &gt; 1 days:      major ticks every 12 hours, minor ticks every  3 hours</p></li>
<li><p>1 days &gt; time_extend &gt; 12 hours:    major ticks every 2 hours, minor ticks every  30 minutes</p></li>
<li><p>12hours &gt; time_extend &gt; 6 hours:    major ticks every 1 hours, minor ticks every  30 minutes</p></li>
<li><p>6 hours &gt; time_extend &gt; 2 hour:     major ticks every hour, minor ticks every  15 minutes</p></li>
<li><p>2 hours &gt; time_extend &gt; 15 min:     major ticks every 15 minutes, minor ticks every 5 minutes</p></li>
<li><p>15 min &gt; time_extend &gt; 5 min:       major ticks every 15 minutes, minor ticks every 5 minutes</p></li>
<li><p>else:                               major ticks every minute, minor ticks every 10 seconds</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – axis in which the y-ticks and labels have to be set</p></li>
<li><p><strong>time_extend</strong> – time difference of t_end - t_start (format datetime.timedelta)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ax - axis with new ticks and labels</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.setup_logging">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#setup_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.setup_logging" title="Link to this definition"></a></dt>
<dd><p>Setup up logging to file if script is called from console. If it is executed inside a console setup logging only
to console.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> – Directory where to save logging file. Gets created if it doesn’t exist yet.</p></li>
<li><p><strong>file</strong> – Name of the file which called the function. Should be given via the __file__ attribute.</p></li>
<li><p><strong>custom_string</strong> – Custom String to append to logging file name. Logging file always starts with date and the name
of the script being called.</p></li>
</ul>
</dd>
</dl>
<p>Returns: Logger</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.helpers.strtobool">
<span class="sig-prename descclassname"><span class="pre">pylim.helpers.</span></span><span class="sig-name descname"><span class="pre">strtobool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/helpers.html#strtobool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.helpers.strtobool" title="Link to this definition"></a></dt>
<dd><p>Convert a string representation of a boolean value to a Python boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String representation of a boolean value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Python boolean value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pylim.libradtran">
<span id="libradtran"></span><h2>libradtran<a class="headerlink" href="#module-pylim.libradtran" title="Link to this heading"></a></h2>
<p>Functions to process and plot libRadtran simulation files</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.libradtran.find_closest_radiosonde_station">
<span class="sig-prename descclassname"><span class="pre">pylim.libradtran.</span></span><span class="sig-name descname"><span class="pre">find_closest_radiosonde_station</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/libradtran.html#find_closest_radiosonde_station"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.libradtran.find_closest_radiosonde_station" title="Link to this definition"></a></dt>
<dd><p>Given longitude and latitude, find the closest radiosonde station from the campaign dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> – in decimal degrees (N=positive)</p></li>
<li><p><strong>longitude</strong> – in decimal degrees (E=positive)</p></li>
</ul>
</dd>
</dl>
<p>Returns: Name of the closest radiosonde station</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.libradtran.get_info_from_libradtran_input">
<span class="sig-prename descclassname"><span class="pre">pylim.libradtran.</span></span><span class="sig-name descname"><span class="pre">get_info_from_libradtran_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/pylim/libradtran.html#get_info_from_libradtran_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.libradtran.get_info_from_libradtran_input" title="Link to this definition"></a></dt>
<dd><p>Open a libRadtran input file and read out some information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to file</p>
</dd>
</dl>
<p>Returns: Some variables (latitude, longitude, time, header of output file, wavelength range, integrate flag)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.libradtran.get_netcdf_global_attributes">
<span class="sig-prename descclassname"><span class="pre">pylim.libradtran.</span></span><span class="sig-name descname"><span class="pre">get_netcdf_global_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/libradtran.html#get_netcdf_global_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.libradtran.get_netcdf_global_attributes" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary with globa attributes for a libRadtran simulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campaign</strong> – which campaign (cirrus-hl, halo-ac3)</p></li>
<li><p><strong>flight</strong> – which flight</p></li>
<li><p><strong>experiment</strong> – which experiment has been run</p></li>
</ul>
</dd>
</dl>
<p>Returns: dictionary with global attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.libradtran.get_netcdf_variable_attributes">
<span class="sig-prename descclassname"><span class="pre">pylim.libradtran.</span></span><span class="sig-name descname"><span class="pre">get_netcdf_variable_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solar_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrate_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/libradtran.html#get_netcdf_variable_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.libradtran.get_netcdf_variable_attributes" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary with variable attributes for a libRadtran simulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solar_flag</strong> – whether the simulation was a solar or a terrestrial simulation</p></li>
<li><p><strong>integrate_str</strong> – whether the simulations was integrated at the end or not</p></li>
<li><p><strong>wavelength_str</strong> – wavelength range of the simulation</p></li>
</ul>
</dd>
</dl>
<p>Returns: dictionary with variable attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.libradtran.run_uvspec_parallel">
<span class="sig-prename descclassname"><span class="pre">pylim.libradtran.</span></span><span class="sig-name descname"><span class="pre">run_uvspec_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvspec_exe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/libradtran.html#run_uvspec_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.libradtran.run_uvspec_parallel" title="Link to this definition"></a></dt>
<dd><p>Run libRadtran simulations for all input files in parallel and check if an output has been created.
Rerun the failed simulations a couple of times before quitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> – list with full paths to each input file</p></li>
<li><p><strong>uvspec_exe</strong> – path to uvspec executable</p></li>
</ul>
</dd>
</dl>
<p>Returns: Writes output and log files in directory of the input files</p>
<p>Raises: UsesWarning if a simulation fails more than 10 times</p>
</dd></dl>

</section>
<section id="module-pylim.meteorological_formulas">
<span id="meteorological-formulas"></span><h2>meteorological_formulas<a class="headerlink" href="#module-pylim.meteorological_formulas" title="Link to this heading"></a></h2>
<p>General meteorological formulas</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.barometric_height">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">barometric_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature_profile</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#barometric_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.barometric_height" title="Link to this definition"></a></dt>
<dd><p>Calculate the barometric height from a pressure and temperature profile.</p>
<div class="math notranslate nohighlight">
\[\Delta h = \frac{\log\left(\frac{p(h_1)}{p(h_0)}\right) * R * T(h_1)}{M * g}\]</div>
<p>with <span class="math notranslate nohighlight">\(h\)</span> the height in meter, <span class="math notranslate nohighlight">\(R\)</span> the universal gas constant, <span class="math notranslate nohighlight">\(T\)</span> the temperature in Kelvin,
<span class="math notranslate nohighlight">\(M\)</span> the molar mass of air and <span class="math notranslate nohighlight">\(g\)</span> earth’s acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure_profile</strong> – pressure profile (Pa)</p></li>
<li><p><strong>temperature_profile</strong> – temperature profile (K)</p></li>
</ul>
</dd>
</dl>
<p>Returns: barometric height (m)</p>
<p>&#64;author: Hanno Müller, Johannes Röttenbacher</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.barometric_height_simple">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">barometric_height_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#barometric_height_simple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.barometric_height_simple" title="Link to this definition"></a></dt>
<dd><p>Calculate the barometric height assuming a constant temperature of 0°C</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pressure</strong> – pressure profile (Pa)</p>
</dd>
</dl>
<p>Returns: barometric_height</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.calculate_absorption_coefficient_terrestrial">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">calculate_absorption_coefficient_terrestrial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iwc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">916.7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayLike</span></span></span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#calculate_absorption_coefficient_terrestrial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.calculate_absorption_coefficient_terrestrial" title="Link to this definition"></a></dt>
<dd><p>Calculate the absorption coefficient (<span class="math notranslate nohighlight">\(\beta_{abs}\)</span>) of an ice cloud layer in the terrestrial wavelength
range using the geometric optic assumption (ice particles are large compared to the incoming radiation)
according to Eq. 7 in <span id="id3">Francis <em>et al.</em> [<a class="reference internal" href="references.html#id176" title="P. N. Francis, A. Jones, R. W. Saunders, K. P. Shine, A. Slingo, and Zhian Sun. An observational and theoretical study of the radiative properties of cirrus: Some results from ICE'89. Quart. J. Roy. Meteorol. Soc., 120(518):809–848, July 1994. doi:10.1002/qj.49712051804.">1994</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[\beta_{abs} = \frac{3}{4} \frac{IWC}{\rho_{ice}r_{eff}}\]</div>
<p>with <span class="math notranslate nohighlight">\(\rho_{ice}\)</span> the density of ice and <span class="math notranslate nohighlight">\(r_{eff}\)</span> the ice effective radius according to <span id="id4">Foot [<a class="reference internal" href="references.html#id165" title="J. S. Foot. Some observations of the optical properties of clouds. II: Cirrus. Quart. J. Roy. Meteorol. Soc., 114(479):145–164, January 1988. doi:10.1002/qj.49711447908.">1988</a>]</span>.</p>
<p>Integrating this over altitude results in the optical depth of the ice cloud layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iwc</strong> – Ice water content in kg/m^3</p></li>
<li><p><strong>reff</strong> – Ice effective radius in m</p></li>
<li><p><strong>density</strong> – Density of ice in kg/m^3</p></li>
</ul>
</dd>
</dl>
<p>Returns: Absorption coefficient in m^-1 of the ice cloud layer in the solar wavelength range</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.calculate_direct_sea_ice_albedo_ebert">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">calculate_direct_sea_ice_albedo_ebert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cos_sza</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#calculate_direct_sea_ice_albedo_ebert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.calculate_direct_sea_ice_albedo_ebert" title="Link to this definition"></a></dt>
<dd><p>Calculate the direct dry snow covered sea ice albedo for a specific solar zenith angle according to <span id="id5">Ebert and Curry [<a class="reference internal" href="references.html#id132" title="Elizabeth E. Ebert and Judith A. Curry. An intermediate one-dimensional thermodynamic sea ice model for investigating ice-atmosphere interactions. Journal of Geophysical Research: Oceans, 98(C6):10085–10109, 1993. doi:10.1029/93JC00656.">1993</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cos_sza</strong> – Cosine of the solar zenith angle</p>
</dd>
</dl>
<p>Returns: direct albedo of dry snow covered sea ice</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.calculate_extinction_coefficient_solar">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">calculate_extinction_coefficient_solar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iwc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">916.7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArrayLike</span></span></span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#calculate_extinction_coefficient_solar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.calculate_extinction_coefficient_solar" title="Link to this definition"></a></dt>
<dd><p>Calculate the extinction coefficient (<span class="math notranslate nohighlight">\(\beta_{ext}\)</span>) of an ice cloud layer in the solar wavelength range
using the geometric optic assumption (ice particles are large compared to the incoming radiation)
according to Eq. 10 in <span id="id6">Francis <em>et al.</em> [<a class="reference internal" href="references.html#id176" title="P. N. Francis, A. Jones, R. W. Saunders, K. P. Shine, A. Slingo, and Zhian Sun. An observational and theoretical study of the radiative properties of cirrus: Some results from ICE'89. Quart. J. Roy. Meteorol. Soc., 120(518):809–848, July 1994. doi:10.1002/qj.49712051804.">1994</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[\beta_{ext} = \frac{3}{2} \frac{IWC}{\rho_{ice}r_{eff}}\]</div>
<p>with <span class="math notranslate nohighlight">\(\rho_{ice}\)</span> the density of ice and <span class="math notranslate nohighlight">\(r_{eff}\)</span> the ice effective radius according to <span id="id7">Foot [<a class="reference internal" href="references.html#id165" title="J. S. Foot. Some observations of the optical properties of clouds. II: Cirrus. Quart. J. Roy. Meteorol. Soc., 114(479):145–164, January 1988. doi:10.1002/qj.49711447908.">1988</a>]</span>.</p>
<p>Integrating this over altitude results in the optical depth of the ice cloud layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iwc</strong> – Ice water content in kg/m^3</p></li>
<li><p><strong>reff</strong> – Ice effective radius in m</p></li>
<li><p><strong>density</strong> – Density of ice in kg/m^3</p></li>
</ul>
</dd>
</dl>
<p>Returns: Extinction coefficient in m^-1 of the ice cloud layer in the solar wavelength range</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.calculate_open_ocean_albedo_taylor">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">calculate_open_ocean_albedo_taylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cos_sza</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#calculate_open_ocean_albedo_taylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.calculate_open_ocean_albedo_taylor" title="Link to this definition"></a></dt>
<dd><p>Calculate the open ocean albedo for direct incoming solar irradiance following <span id="id8">Taylor <em>et al.</em> [<a class="reference internal" href="references.html#id646" title="J. P. Taylor, J. M. Edwards, M. D. Glew, P. Hignett, and A. Slingo. Studies with a flexible new radiation code. II: Comparisons with aircraft short-wave observations. Q. J. R. Meteorolog. Soc., 122(532):839–861, April 1996. doi:10.1002/qj.49712253204.">1996</a>]</span>.</p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{0.037}{1.1 * \cos(\theta)^{1.4} + 0.15}\]</div>
<p>with <span class="math notranslate nohighlight">\(\theta\)</span> being the solar zenith angle in radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cos_sza</strong> – cosine of the solar zenith angle</p>
</dd>
</dl>
<p>Returns: open ocean albedo</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.meteorological_formulas.relative_humidity_water_to_relative_humidity_ice">
<span class="sig-prename descclassname"><span class="pre">pylim.meteorological_formulas.</span></span><span class="sig-name descname"><span class="pre">relative_humidity_water_to_relative_humidity_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_humidity_water</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'huang'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/meteorological_formulas.html#relative_humidity_water_to_relative_humidity_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.meteorological_formulas.relative_humidity_water_to_relative_humidity_ice" title="Link to this definition"></a></dt>
<dd><p>Convert the relative humidity over water to relative humidity over ice using either the formulas by
<span id="id9">Huang [<a class="reference internal" href="references.html#id266" title="Jianhua Huang. A Simple Accurate Formula for Calculating Saturation Vapor Pressure of Water and Ice. J. Appl. Meteorol. Clim., 57(6):1265–1272, June 2018. doi:10.1175/jamc-d-17-0334.1.">2018</a>]</span> or by <span id="id10">Alduchov and Eskridge [<a class="reference internal" href="references.html#id16" title="Oleg A. Alduchov and Robert E. Eskridge. Improved Magnus Form Approximation of Saturation Vapor Pressure. J Appl Meteorol, 35(4):601–609, April 1996. doi:10.1175/1520-0450(1996)035&lt;0601:imfaos&gt;2.0.co;2.">1996</a>]</span>.</p>
<div class="math notranslate nohighlight">
\[RH_{ice} = \frac{RH_{water} * e_{s,w}}{e_{s,i}}\]</div>
<p>with <span class="math notranslate nohighlight">\(e_{s,w}\)</span> the saturation vapor pressure of water and <span class="math notranslate nohighlight">\(e_{s,i}\)</span> the saturation vapor pressure of ice:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}e_{s,w} = \frac{\exp\left(34.494 - \frac{4924.99}{t + 237.1}\right)}{(t + 105)^{1.157}} (t &gt; 0°C)\\e_{s,i} = \frac{\exp\left(43.494 - \frac{6545.8}{t + 278}\right)}{(t + 868)^{2}} (t \le 0°C)\end{aligned}\end{align} \]</div>
<p>with <span class="math notranslate nohighlight">\(t\)</span> being the temperature in °C. When version is <code class="docutils literal notranslate"><span class="pre">alduchov</span></code> the following equations are used:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}e_{s,w} = 6.1094 * \exp\left(\frac{17.625 * t}{243.04 + t}\right)\\e_{s,i} = 6.1121 * \exp\left(\frac{22.587 * t}{273.86 + t}\right)\end{aligned}\end{align} \]</div>
<p>with <span class="math notranslate nohighlight">\(t\)</span> the temperature in °C.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_humidity_water</strong> – ambient relative humidity in percent</p></li>
<li><p><strong>temperature</strong> – ambient temperature in °C</p></li>
<li><p><strong>version</strong> – which formulas to use for calculating the saturation vapor pressure of water and ice (‘huang’ or ‘alduchov’)</p></li>
</ul>
</dd>
</dl>
<p>Returns: relative humidity over ice</p>
</dd></dl>

</section>
<section id="module-pylim.reader">
<span id="reader"></span><h2>reader<a class="headerlink" href="#module-pylim.reader" title="Link to this heading"></a></h2>
<p>A collection of reader functions for instruments operated on HALO and model output files</p>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_bacardi_raw">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_bacardi_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_bacardi_raw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_bacardi_raw" title="Link to this definition"></a></dt>
<dd><p>Read raw BACARDI data as provided by DLR</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of file</p></li>
<li><p><strong>path</strong> – path to file</p></li>
</ul>
</dd>
</dl>
<p>Returns: Dataset with BACARDI data and time as dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_bahamas">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_bahamas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bahamas_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_bahamas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_bahamas" title="Link to this definition"></a></dt>
<dd><p>Reader function for netcdf BAHAMAS data as provided by DLR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bahamas_path</strong> – full path of netcdf file</p>
</dd>
</dl>
<p>Returns: xr.DataSet with BAHAMAS data and time as dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_cams_file">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_cams_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_cams_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_cams_file" title="Link to this definition"></a></dt>
<dd><p>Read a CAMS atmosphere file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – full path to nc file</p>
</dd>
</dl>
<p>Returns: DataSet with</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_ecrad_output">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_ecrad_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_ecrad_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_ecrad_output" title="Link to this definition"></a></dt>
<dd><p>Read in and preprocess a merged ecRad output file from :py:module:ecrad_merge_files.py</p>
<ul class="simple">
<li><p>Assign coordinates to dimensions</p></li>
<li><p>Calculate pressure height in m</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – Full path to file</p>
</dd>
</dl>
<p>Returns: xarray DataSet with added coordinates to all dimensions of the file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_ins_gps_pos">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_ins_gps_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_ins_gps_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_ins_gps_pos" title="Link to this definition"></a></dt>
<dd><p>Read in a GPS position file as returned by the HALO-SMART INS system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – complete path to Nav_GPSPosxxxx.Asc file</p>
</dd>
</dl>
<p>Returns: time series with the GPS position data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_ins_gps_vel">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_ins_gps_vel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_ins_gps_vel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_ins_gps_vel" title="Link to this definition"></a></dt>
<dd><p>Read in a GPS velocity file as returned by the HALO-SMART INS system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – complete path to Nav_GPSVelxxxx.Asc file</p>
</dd>
</dl>
<p>Returns: time series with the GPS velocity data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_lamp_file">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_lamp_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cirrus-hl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_lamp_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_lamp_file" title="Link to this definition"></a></dt>
<dd><p>Read in the 1000W lamp specification file interpolated to 1nm steps. Converts W/cm^2 to W/m^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campaign</strong> – for which campaign should the lamp file be read in?</p></li>
<li><p><strong>filename</strong> – name of lamp file to be read in</p></li>
<li><p><strong>plot</strong> – plot lamp file?</p></li>
<li><p><strong>save_fig</strong> – save figure to standard plot path defined in config.toml?</p></li>
<li><p><strong>save_file</strong> – save lamp file to standard calib path deined in config.toml?</p></li>
</ul>
</dd>
</dl>
<p>Returns: A data frame with the irradiance in W/m² and the corresponding wavelength in nm</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_libradtran">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_libradtran</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_libradtran"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_libradtran" title="Link to this definition"></a></dt>
<dd><p>Read an old libRadtran simulation file generated by <code class="docutils literal notranslate"><span class="pre">01_dirdiff_BBR_Cirrus_HL_Server_jr.pro</span></code> and add a DateTime Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight</strong> – which flight does the simulation belong to (e.g. Flight_20210629a)</p></li>
<li><p><strong>filename</strong> – filename</p></li>
</ul>
</dd>
</dl>
<p>Returns: DataFrame with libRadtran output data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_nav_data">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_nav_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_nav_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_nav_data" title="Link to this definition"></a></dt>
<dd><p>Reader function for Navigation data file from the INS used by the stabilization of SMART</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nav_path</strong> – path to IMS file including filename</p>
</dd>
</dl>
<p>Returns: pandas DataFrame with headers and a DateTimeIndex</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_ozone_sonde">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_ozone_sonde</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/reader.html#read_ozone_sonde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_ozone_sonde" title="Link to this definition"></a></dt>
<dd><p>Reader function for ames formatted ozone sonde data from <a class="reference external" href="http://www.ndaccdemo.org/">http://www.ndaccdemo.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – complete path to file</p>
</dd>
</dl>
<p>Returns: pandas DataFrame with ozone volume mixing ratio</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_pixel_to_wavelength">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_pixel_to_wavelength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrometer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_pixel_to_wavelength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_pixel_to_wavelength" title="Link to this definition"></a></dt>
<dd><p>Read file which maps each pixel to a certain wavelength for a specified spectrometer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path where to find file</p></li>
<li><p><strong>spectrometer</strong> – For which spectrometer the pixel to wavelength mapping should be read in, refer to lookup table for possible
spectrometers (e.g. ASP06_J3)</p></li>
</ul>
</dd>
</dl>
<p>Returns: pandas DataFrame relating pixel number to wavelength</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_smart_cor">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_smart_cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_smart_cor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_smart_cor" title="Link to this definition"></a></dt>
<dd><p>Read dark current corrected SMART data files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path where to find file</p></li>
<li><p><strong>filename</strong> – Name of file</p></li>
</ul>
</dd>
</dl>
<p>Returns: pandas DataFrame with column names and datetime index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_smart_raw">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_smart_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_smart_raw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_smart_raw" title="Link to this definition"></a></dt>
<dd><p>Read raw SMART data files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path where to find file</p></li>
<li><p><strong>filename</strong> – Name of file</p></li>
</ul>
</dd>
</dl>
<p>Returns: pandas DataFrame with column names and datetime index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.reader.read_stabbi_data">
<span class="sig-prename descclassname"><span class="pre">pylim.reader.</span></span><span class="sig-name descname"><span class="pre">read_stabbi_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stabbi_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/pylim/reader.html#read_stabbi_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.reader.read_stabbi_data" title="Link to this definition"></a></dt>
<dd><p>Read in stabilization platform data from SMART.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stabbi_path</strong> – full path to dat file</p>
</dd>
</dl>
<p>Returns: pandas DataFrame with headers and a DateTimeIndex</p>
</dd></dl>

</section>
<section id="module-pylim.smart">
<span id="smart"></span><h2>smart<a class="headerlink" href="#module-pylim.smart" title="Link to this heading"></a></h2>
<p>These are functions in relation with the SMART instrument.</p>
<p>“_” denotes internal functions which are called inside other functions.</p>
<p>The functions are explained in their docstring and can be tested using the main frame.
You can:</p>
<p>The reader functions were moved to <a class="reference internal" href="#module-pylim.reader" title="pylim.reader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylim.reader</span></code></a>.</p>
<ul class="simple">
<li><p>find the closest pixel and wavelength to any given wavelength for the given wavelength calibration file</p></li>
<li><p>get information (date, measured property, channel) from the filename</p></li>
<li><p>get the dark current for a specified measurement file with either option 1 or 2 and optionally plot it</p></li>
<li><p>correct the raw measurement by the dark current</p></li>
<li><p>plot the mean corrected measurement</p></li>
<li><p>plot smart data either for one wavelength over time or for a range of or all wavelengths</p></li>
<li><p>use the holoviews functions to create a dynamic map for interactive quicklooks in a jupyter notebook</p></li>
</ul>
<p><em>author</em>: Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.correct_smart_dark_current">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">correct_smart_dark_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smart_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#correct_smart_dark_current"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.correct_smart_dark_current" title="Link to this definition"></a></dt>
<dd><p>Correct the raw SMART measurement for the dark current of the spectrometer.
Only returns data when the shutter was open.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight</strong> – to which flight does the file belong to? (e.g. Flight_20210707a)</p></li>
<li><p><strong>smart_file</strong> – filename of file to correct</p></li>
<li><p><strong>option</strong> – which option should be used to get the dark current? Only relevant for channel “VNIR”.</p></li>
<li><p><strong>kwargs</strong> – path (str): path to file if not raw file path as given in config.toml,
date (str): (yyyymmdd) date from which the dark current measurement should be used for VNIR (necessary if             no transfer calibration was made on a measurement day)
campaign (str): campaign to which smart file belongs to</p></li>
</ul>
</dd>
</dl>
<p>Returns: Series with corrected smart measurement</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.find_pixel">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">find_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pylim/smart.html#find_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.find_pixel" title="Link to this definition"></a></dt>
<dd><p>Given the dataframe with the pixel to wavelength mapping, return the pixel and wavelength closest to the requested
wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – Dataframe with column pixel and wavelength (from read_pixel_to_wavelength)</p></li>
<li><p><strong>wavelength</strong> – which wavelength are you interested in</p></li>
</ul>
</dd>
</dl>
<p>Returns: closest pixel number and wavelength corresponding to the given wavelength</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.get_dark_current">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">get_dark_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">figure</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#get_dark_current"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.get_dark_current" title="Link to this definition"></a></dt>
<dd><p>Get the corresponding dark current for the specified measurement file to correct the raw SMART measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flight</strong> – to which flight does the file belong to? (e.g. Flight_20210707a)</p></li>
<li><p><strong>filename</strong> – filename (e.g. “2021_03_29_11_07.Fup_SWIR.dat”) of measurement file</p></li>
<li><p><strong>option</strong> – which option to use for VNIR (1, 2 or 3).
Option 1: use measurements below 290 nm.
Option 2: use dark measurements from transfer calibration (CIRRUS-HL folder structure expected).
Option 3: use scaled dark current measurement from transfer calibration (HALO-AC3 folder structure expected).</p></li>
<li><p><strong>**kwargs</strong> – path (str): path to measurement file if not standard path from config.toml,
plot (bool): show plot or not (default: True),
date (str): yyyymmdd, date of transfer calibration with dark current measurement to use
dark_filepath (str): complete path to dark current file to use
campaign (str): campaign to which smart file belongs to</p></li>
</ul>
</dd>
</dl>
<p>Returns: pandas Series with the mean dark current measurements over time for each pixel and optionally a plot of it</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.get_info_from_filename">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">get_info_from_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pylim/smart.html#get_info_from_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.get_info_from_filename" title="Link to this definition"></a></dt>
<dd><p>Using regular expressions some information from the filename is extracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – string in the form yyyy_mm_dd_hh_MM.[F/I][up/dw]_[SWIR/VNIR].dat (eg. “2021_03_29_11_07.Fup_SWIR.dat”)</p>
</dd>
</dl>
<p>Returns: A date string, the channel and the direction of measurement including the quantity.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.merge_vnir_swir_nc">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">merge_vnir_swir_nc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vnir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#merge_vnir_swir_nc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.merge_vnir_swir_nc" title="Link to this definition"></a></dt>
<dd><p>Merge the SMART nc files generated by smart_write_ncfile.py
:param vnir: VNIR data set
:param swir: SWIR data set</p>
<p>Returns: merged data set</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_calibrated_irradiance_flux">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_calibrated_irradiance_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Overlay</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_calibrated_irradiance_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_calibrated_irradiance_flux" title="Link to this definition"></a></dt>
<dd><p>Plot upward and downward irradiance as a time averaged series over the wavelength or as a time series for one
wavelength.
:param campaign: campaign name (cirrus-hl or halo-ac3)
:param filename: Standard SMART filename
:param wavelength: single or range of wavelength or “all”
:param flight: flight folder (flight_xx)</p>
<p>Returns: holoviews overlay plot with two curves</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_complete_smart_spectra">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_complete_smart_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_complete_smart_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_complete_smart_spectra" title="Link to this definition"></a></dt>
<dd><p>Plot the complete spectra given by both channels from SMART calibrated measurement files for a given index (time step)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – where the file can be found</p></li>
<li><p><strong>campaign</strong> – campaign name (cirrus-hl or halo-ac3)</p></li>
<li><p><strong>filename</strong> – name of the file (standard SMART filename convention)</p></li>
<li><p><strong>index</strong> – which row to plot</p></li>
<li><p><strong>**kwargs</strong> – save_fig (bool): Save figure to plot path given in config.toml (default: False)
plot_path (str): Where to save plot if not standard plot path</p></li>
</ul>
</dd>
</dl>
<p>Returns: Shows and or saves a plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_complete_smart_spectra_interactive">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_complete_smart_spectra_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Overlay</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_complete_smart_spectra_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_complete_smart_spectra_interactive" title="Link to this definition"></a></dt>
<dd><p>Plot the complete spectra given by both channels from SMART calibrated measurement files for a given index (time step)
:param path: where the file can be found
:param campaign: campaign name (cirrus-hl or halo-ac3)
:param filename: name of the file (standard SMART filename convention)
:param index: which row to plot</p>
<p>Returns: Shows and or saves a plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_mean_corrected_measurement">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_mean_corrected_measurement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement_cor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/smart.html#plot_mean_corrected_measurement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_mean_corrected_measurement" title="Link to this definition"></a></dt>
<dd><p>Plot the mean dark current corrected SMART measurement over time together with the raw measurement and the dark
current.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campaign</strong> – campaign name (cirrus-hl or halo-ac3)</p></li>
<li><p><strong>flight</strong> – to which flight does the file belong to? (e.g. Flight_20210707a)</p></li>
<li><p><strong>filename</strong> – name of file</p></li>
<li><p><strong>measurement</strong> – raw SMART measurements for each pixel averaged over time</p></li>
<li><p><strong>measurement_cor</strong> – corrected SMART measurements for each pixel averaged over time</p></li>
<li><p><strong>option</strong> – which option was used for VNIR correction</p></li>
<li><p><strong>**kwargs</strong> – save_fig (bool): save figure to current directory or just show it</p></li>
</ul>
</dd>
</dl>
<p>Returns: plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_smart_data">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_smart_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">axes</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_smart_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_smart_data" title="Link to this definition"></a></dt>
<dd><p>Plot SMART data in the given file. Either a time average over a range of wavelengths or all wavelengths,
or a time series of one wavelength. Return an axes object to continue plotting or show it.
TODO: add option to plot multiple files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campaign</strong> – campaign name (cirrus-hl or halo-ac3)</p></li>
<li><p><strong>flight</strong> – to which flight does the file belong to? (e.g. Flight_20210707a)</p></li>
<li><p><strong>filename</strong> – Standard SMART filename</p></li>
<li><p><strong>wavelength</strong> – list with either one or two wavelengths in nm or ‘all’</p></li>
<li><p><strong>**kwargs</strong> – path (str): give path to filename if not default from config.toml,
save_fig (bool): save figure? (default: False),
plot_path (str): where to save figure (default: given in config.toml)
ax (plt.axis): axes to already existing matplotlib axis</p></li>
</ul>
</dd>
</dl>
<p>Returns: Shows a figure or saves it to disc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_smart_data_interactive">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_smart_data_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Curve</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_smart_data_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_smart_data_interactive" title="Link to this definition"></a></dt>
<dd><p>Plot SMART data in the given file. Either a time average over a range of wavelengths or all wavelengths,
or a time series of one wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campaign</strong> – campaign name (cirrus-hl or halo-ac3)</p></li>
<li><p><strong>flight</strong> – to which flight does the file belong to? (e.g. Flight_20210707a)</p></li>
<li><p><strong>filename</strong> – Standard SMART filename</p></li>
<li><p><strong>wavelength</strong> – list with either one or two wavelengths in nm or ‘all’</p></li>
</ul>
</dd>
</dl>
<p>Returns: Creates an interactive figure</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_smart_ecrad_bands">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_smart_ecrad_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/smart.html#plot_smart_ecrad_bands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_smart_ecrad_bands" title="Link to this definition"></a></dt>
<dd><p>Plot banded upward and downward irradiance for given ecRad bands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smart</strong> – SMART data set containing variables fdn_banded and fup_banded</p></li>
<li><p><strong>bands</strong> – ecRad band numbers</p></li>
<li><p><strong>path</strong> – where to save figure to</p></li>
<li><p><strong>save_fig</strong> – whether to save figure</p></li>
</ul>
</dd>
</dl>
<p>Returns: figure</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.smart.plot_smart_spectra">
<span class="sig-prename descclassname"><span class="pre">pylim.smart.</span></span><span class="sig-name descname"><span class="pre">plot_smart_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">campaign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pylim/smart.html#plot_smart_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.smart.plot_smart_spectra" title="Link to this definition"></a></dt>
<dd><p>Plot a spectra from a SMART calibrated measurement file for a given index (time step)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – where the file can be found</p></li>
<li><p><strong>campaign</strong> – campaign name (cirrus-hl or halo-ac3)</p></li>
<li><p><strong>filename</strong> – name of the file (standard SMART filename convention)</p></li>
<li><p><strong>index</strong> – which row to plot</p></li>
<li><p><strong>**kwargs</strong> – save_fig (bool): Save figure to plot path given in config.toml (default: False),
plot_path (str): Where to save plot if not standard plot path</p></li>
</ul>
</dd>
</dl>
<p>Returns: Shows and or saves a plot</p>
</dd></dl>

</section>
<section id="module-pylim.solar_position">
<span id="solar-position"></span><h2>solar_position<a class="headerlink" href="#module-pylim.solar_position" title="Link to this heading"></a></h2>
<p>Functions calculating the solar position</p>
<p><strong>author:</strong> Hanno Müller, Johannes Röttenbacher</p>
<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.dec">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#dec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.dec" title="Link to this definition"></a></dt>
<dd><p>Declination calculated after Michalsky, J.  1988.
<strong>Reference</strong>: Michalsky, J.  1988. The Astronomical Almanac’s algorithm for approximate solar position (1950-2050). Solar Energy 40 (3), pp. 227-235.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>julian</strong> – julian day (day of year) as calculated with julian2.pro</p></li>
<li><p><strong>year</strong> – The year (e.g., 2020)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>declination in (deg)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dec</span><span class="p">(</span><span class="mi">303</span><span class="p">,</span> <span class="mi">2020</span><span class="p">)</span>
<span class="go">-13.52916587749051</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.get_saa">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">get_saa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#get_saa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.get_saa" title="Link to this definition"></a></dt>
<dd><p>Calculates the solar azimuth angles.
Requires function julian_day,local_time,dec
:param t0: Time in UTC (in decimal hours, i.e. 10.5 for 10h30min)
:param lat: Latitude (North positive)
:param lon: Longitude (East positive)
:param year: The year  (e.g. 2020)
:param month: The month (1-12)
:param day: The day (1-31)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The solar azimuth angle (deg)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">azimuth</span> <span class="o">=</span> <span class="n">get_saa</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">51.34</span><span class="p">,</span> <span class="mf">12.376</span><span class="p">,</span> <span class="mi">2022</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">azimuth</span>
<span class="go">173.75177751099122</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.get_sza">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">get_sza</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#get_sza"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.get_sza" title="Link to this definition"></a></dt>
<dd><p>Calculates the solar zenith angle
Requires function julian_day,local_time,dec,refract</p>
<p>Copyright by Sebastian Schmidt</p>
<p>changes by Andre Ehrlich:
- new declination parametrization after Michalsky, J.  1988. The Astronomical Almanac’s algorithm for approximate solar position (1950-2050).  Solar Energy 40 (3), pp. 227-235.
- refraction correction algorithm from Meeus,1991
- check: for SZA &gt;95 no refraction correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> – Time in UTC (in decimal hours, i.e. 10.5 for 10h30min)</p></li>
<li><p><strong>lat</strong> – Latitude (North positive)</p></li>
<li><p><strong>lon</strong> – Longitude (East positive)</p></li>
<li><p><strong>year</strong> – The year  (e.g. 2020)</p></li>
<li><p><strong>month</strong> – The month (1-12)</p></li>
<li><p><strong>day</strong> – The day (1-31)</p></li>
<li><p><strong>pres</strong> – Surface Pressure in hPa (for refraction correction)</p></li>
<li><p><strong>temp</strong> – Surface Temperature in deg C (for refraction correction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The solar zenith angle (deg)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.julian_day">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">julian_day</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#julian_day"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.julian_day" title="Link to this definition"></a></dt>
<dd><p>Returns the day of the year (julian_day) for a given date. Jan 1 = 1, Feb 1 = 32 etc.
Considers leap years and the time of day.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> – The year (e.g. 2020)</p></li>
<li><p><strong>month</strong> – The month (1-12)</p></li>
<li><p><strong>day</strong> – The day (1-31)</p></li>
<li><p><strong>t0</strong> – Time in UTC (dezimal hours)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A value between 1 and 366, corresponding to the day of the year of year/month/day.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jd</span> <span class="o">=</span> <span class="n">julian_day</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jd</span>
<span class="go">45.28333333333333</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.local_time">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">local_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">julian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#local_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.local_time" title="Link to this definition"></a></dt>
<dd><p>Calculates the local solar time by accounting for
- longitude
- time equation (two versions are implemented, one commented, both are almost identical)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>julian</strong> – julian day (day of year) as calculated with julian2.pro</p></li>
<li><p><strong>t0</strong> – Time in UTC (in decimal hours, i.e. 10.5 for 10h30min)</p></li>
<li><p><strong>lon</strong> – Longitude (East positive)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Local solar time (in decimal hours, i.e. 10.5 for 10h30min)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solar_local_time</span> <span class="o">=</span> <span class="n">local_time</span><span class="p">(</span><span class="mi">265</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solar_local_time</span>
<span class="go">6.2521447402113886</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylim.solar_position.refract">
<span class="sig-prename descclassname"><span class="pre">pylim.solar_position.</span></span><span class="sig-name descname"><span class="pre">refract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pylim/solar_position.html#refract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylim.solar_position.refract" title="Link to this definition"></a></dt>
<dd><p>Correction of the solar elevation angle for refraction
<strong>Reference</strong>: J.Meeus, Astronomical Algorithms, 1991, pp102</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elv</strong> – solar elevation (rad)</p></li>
<li><p><strong>pres</strong> – station pressure (hPa)</p></li>
<li><p><strong>temp</strong> – station temperature (°C)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>corrected_elv = elv + refcor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Refraction correction offset (rad) which needs to be applied after-wards</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refcor</span> <span class="o">=</span> <span class="n">refract</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refcor</span>
<span class="go">0.0003679487426608174</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup.html" class="btn btn-neutral float-left" title="Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="references.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-, Radiation Group LIM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>